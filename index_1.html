<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>ë²„ë¸”ë²„ë¸” ìŠˆí„° (ëª¨ë°”ì¼ ëŒ€ì‘)</title>
  <style>
    :root{--bg:#0b1024;--panel:#111827;--text:#e5e7eb;--accent:#38bdf8}
    html,body{height:100%;margin:0}
    body{
      display:grid;place-items:center;
      background:radial-gradient(1200px 800px at 70% -20%, #1f2937, #0b1024 60%, #050816 100%);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Noto Sans KR,sans-serif;color:var(--text);
      overflow:hidden;               /* ìŠ¤í¬ë¡¤ ë°©ì§€ */
      touch-action:none;             /* ë”ë¸”íƒ­ í™•ëŒ€ ë°©ì§€ìš© */
    }
    .wrap{width:100vw; max-width:560px}
    .hud{
      display:grid;grid-template-columns:1fr auto;gap:.5rem;align-items:center;
      background:rgba(17,24,39,.65);backdrop-filter:blur(4px);
      border:1px solid #263146;border-bottom:none;border-radius:16px 16px 0 0;
      padding:.5rem .8rem
    }
    .title{font-weight:700;letter-spacing:.2px;font-size:clamp(14px,3.2vw,16px)}
    .btns{display:flex;gap:.5rem}
    button{all:unset;background:#0f172a;border:1px solid #273247;padding:.35rem .7rem;border-radius:10px;cursor:pointer}
    button:active{transform:scale(.98)}
    canvas{display:block;background:linear-gradient(#0a1227,#071022);border:1px solid #263146;border-radius:0 0 16px 16px;width:100%}
    .tips{font-size:12px;opacity:.9;margin-top:.4rem;text-align:center}
    @media (min-width:600px){ .wrap{max-width:800px} }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="hud">
      <div class="title">ğŸ¯ ê°™ì€ ìƒ‰ 3ê°œ ì´ìƒ ë§ì¶”ë©´ ì œê±°!</div>
      <div class="btns">
        <button id="btnRestart">ì¬ì‹œì‘</button>
        <button id="btnAddRow" title="ë‚œì´ë„ ì—…! ìœ„ì—ì„œ í•œ ì¤„ ì¶”ê°€">í•œ ì¤„ ì¶”ê°€</button>
      </div>
    </div>
    <canvas id="game" aria-label="ë²„ë¸”ë²„ë¸” ê²Œì„ ìº”ë²„ìŠ¤"></canvas>
    <div class="tips">í„°ì¹˜ë¡œ ì¡°ì¤€/ë°œì‚¬(íƒ­). A/D ê°ë„, Space ë°œì‚¬, R ì¬ì‹œì‘</div>
  </div>

  <script>
  (()=> {
    const cvs = document.getElementById('game');
    const ctx = cvs.getContext('2d');

    // --------- ëŸ°íƒ€ì„ ë³€í•˜ëŠ” ê°’(ë¦¬ì‚¬ì´ì¦ˆ ëŒ€ì‘) ----------
    let W = 360, H = 640;           // ë…¼ë¦¬ ì¢Œí‘œ(=CSS px)
    const TOP_MARGIN = 70;          // ìƒë‹¨ UI ë†’ì´
    const SIDE_MARGIN = 20;         // ì¢Œìš° ì—¬ë°±
    let LAUNCH_Y = H - 110;

    // ê·¸ë¦¬ë“œ íŒŒë¼ë¯¸í„°(í­ì— ë§ì¶° ë™ì  ì„¤ì •)
    let R = 18;                     // ë²„ë¸” ë°˜ì§€ë¦„
    let DIAM = R*2;
    let COLS = 12;                  // ì§ìˆ˜í–‰ ê¸°ì¤€ ì—´
    let ROW_H = Math.sqrt(3) * R;

    // ìƒ‰ìƒ
    const COLORS = ['#ff6b6b','#ffd93d','#6bcB77','#4d96ff','#bb86fc','#ff9f1c'];

    // ìƒíƒœ
    const state = {
      grid: [], offsetRow: 0, aimAngle:
